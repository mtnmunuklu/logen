<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# logen

```go
import "github.com/mtnmunuklu/logen"
```

## Index



# sigma

```go
import "github.com/mtnmunuklu/logen/sigma"
```

## Index

- [func FuzzConditionParser\(data \[\]byte\) int](<#FuzzConditionParser>)
- [func FuzzConfigParser\(data \[\]byte\) int](<#FuzzConfigParser>)
- [func FuzzRuleParser\(data \[\]byte\) int](<#FuzzRuleParser>)
- [type AggregationExpr](<#AggregationExpr>)
- [type AggregationFunc](<#AggregationFunc>)
- [type AllOfIdentifier](<#AllOfIdentifier>)
- [type AllOfPattern](<#AllOfPattern>)
- [type AllOfThem](<#AllOfThem>)
- [type And](<#And>)
- [type Average](<#Average>)
- [type Comparison](<#Comparison>)
- [type ComparisonOp](<#ComparisonOp>)
- [type Condition](<#Condition>)
  - [func ParseCondition\(input string\) \(Condition, error\)](<#ParseCondition>)
  - [func \(c Condition\) MarshalYAML\(\) \(interface\{\}, error\)](<#Condition.MarshalYAML>)
  - [func \(c Condition\) Position\(\) \(int, int\)](<#Condition.Position>)
- [type Conditions](<#Conditions>)
  - [func \(c Conditions\) MarshalYAML\(\) \(interface\{\}, error\)](<#Conditions.MarshalYAML>)
  - [func \(c \*Conditions\) UnmarshalYAML\(node \*yaml.Node\) error](<#Conditions.UnmarshalYAML>)
- [type Config](<#Config>)
  - [func ParseConfig\(contents \[\]byte\) \(Config, error\)](<#ParseConfig>)
- [type Count](<#Count>)
- [type Detection](<#Detection>)
  - [func \(d \*Detection\) UnmarshalYAML\(node \*yaml.Node\) error](<#Detection.UnmarshalYAML>)
- [type EventMatcher](<#EventMatcher>)
  - [func \(f EventMatcher\) MarshalYAML\(\) \(interface\{\}, error\)](<#EventMatcher.MarshalYAML>)
  - [func \(f \*EventMatcher\) UnmarshalYAML\(node \*yaml.Node\) error](<#EventMatcher.UnmarshalYAML>)
- [type FieldMapping](<#FieldMapping>)
  - [func \(f \*FieldMapping\) UnmarshalYAML\(value \*yaml.Node\) error](<#FieldMapping.UnmarshalYAML>)
- [type FieldMatcher](<#FieldMatcher>)
  - [func \(f FieldMatcher\) Position\(\) \(int, int\)](<#FieldMatcher.Position>)
- [type FileType](<#FileType>)
  - [func InferFileType\(contents \[\]byte\) FileType](<#InferFileType>)
  - [func \(f \*FileType\) UnmarshalYAML\(node \*yaml.Node\) error](<#FileType.UnmarshalYAML>)
- [type Logsource](<#Logsource>)
- [type LogsourceIndexes](<#LogsourceIndexes>)
  - [func \(i \*LogsourceIndexes\) UnmarshalYAML\(value \*yaml.Node\) error](<#LogsourceIndexes.UnmarshalYAML>)
- [type LogsourceMapping](<#LogsourceMapping>)
- [type Max](<#Max>)
- [type Min](<#Min>)
- [type Near](<#Near>)
- [type Not](<#Not>)
- [type OneOfIdentifier](<#OneOfIdentifier>)
- [type OneOfPattern](<#OneOfPattern>)
- [type OneOfThem](<#OneOfThem>)
- [type Or](<#Or>)
- [type RelatedRule](<#RelatedRule>)
- [type Rule](<#Rule>)
  - [func ParseRule\(input \[\]byte\) \(Rule, error\)](<#ParseRule>)
- [type Search](<#Search>)
  - [func \(s Search\) MarshalYAML\(\) \(interface\{\}, error\)](<#Search.MarshalYAML>)
  - [func \(s Search\) Position\(\) \(int, int\)](<#Search.Position>)
  - [func \(s \*Search\) UnmarshalYAML\(node \*yaml.Node\) error](<#Search.UnmarshalYAML>)
- [type SearchExpr](<#SearchExpr>)
- [type SearchIdentifier](<#SearchIdentifier>)
- [type Sum](<#Sum>)


<a name="FuzzConditionParser"></a>
## func [FuzzConditionParser](<https://github.com/mtnmunuklu/logen/blob/main/sigma/fuzz.go#L13>)

```go
func FuzzConditionParser(data []byte) int
```

Try parsing the input data as a Sigma condition, return 0 if it fails \(no match\), 1 otherwise \(match\)

<a name="FuzzConfigParser"></a>
## func [FuzzConfigParser](<https://github.com/mtnmunuklu/logen/blob/main/sigma/fuzz.go#L22>)

```go
func FuzzConfigParser(data []byte) int
```

Try parsing the input data as a Sigma config file, return 0 if it fails \(no match\), 1 otherwise \(match\)

<a name="FuzzRuleParser"></a>
## func [FuzzRuleParser](<https://github.com/mtnmunuklu/logen/blob/main/sigma/fuzz.go#L4>)

```go
func FuzzRuleParser(data []byte) int
```

Try parsing the input data as a Sigma rule, return 0 if it fails \(no match\), 1 otherwise \(match\)

<a name="AggregationExpr"></a>
## type [AggregationExpr](<https://github.com/mtnmunuklu/logen/blob/main/sigma/ast.go#L194-L197>)

Define the AggregationExpr interface with two methods.

```go
type AggregationExpr interface {
    // contains filtered or unexported methods
}
```

<a name="AggregationFunc"></a>
## type [AggregationFunc](<https://github.com/mtnmunuklu/logen/blob/main/sigma/ast.go#L243-L246>)

AggregationFunc is an interface for defining aggregation functions.

```go
type AggregationFunc interface {
    // contains filtered or unexported methods
}
```

<a name="AllOfIdentifier"></a>
## type [AllOfIdentifier](<https://github.com/mtnmunuklu/logen/blob/main/sigma/ast.go#L117-L119>)

AllOfIdentifier is a struct representing a search expression that matches documents containing all of the specified identifiers.

```go
type AllOfIdentifier struct {
    Ident SearchIdentifier
}
```

<a name="AllOfPattern"></a>
## type [AllOfPattern](<https://github.com/mtnmunuklu/logen/blob/main/sigma/ast.go#L132-L134>)

AllOfPattern defines a struct that represents a search query for all occurrences of a given pattern

```go
type AllOfPattern struct {
    Pattern string
}
```

<a name="AllOfThem"></a>
## type [AllOfThem](<https://github.com/mtnmunuklu/logen/blob/main/sigma/ast.go#L169>)

AllOfThem is a struct that represents a search expression for all of the items matching the search criteria.

```go
type AllOfThem struct{}
```

<a name="And"></a>
## type [And](<https://github.com/mtnmunuklu/logen/blob/main/sigma/ast.go#L43>)

And is a type that represents a list of search expressions that are connected with the "and" operator.

```go
type And []SearchExpr
```

<a name="Average"></a>
## type [Average](<https://github.com/mtnmunuklu/logen/blob/main/sigma/ast.go#L307-L310>)

Average represents an aggregation function that calculates the average of a field.

```go
type Average struct {
    Field     string // The field to be averaged.
    GroupedBy string // Optional field to group the results by.
}
```

<a name="Comparison"></a>
## type [Comparison](<https://github.com/mtnmunuklu/logen/blob/main/sigma/ast.go#L228-L232>)

Comparison represents a comparison expression that applies a comparison operator to an aggregation result

```go
type Comparison struct {
    Func      AggregationFunc // the aggregation function to apply
    Op        ComparisonOp    // the comparison operator to use
    Threshold float64         // the threshold value to compare against
}
```

<a name="ComparisonOp"></a>
## type [ComparisonOp](<https://github.com/mtnmunuklu/logen/blob/main/sigma/ast.go#L215>)

ComparisonOp represents the comparison operators used in comparisons

```go
type ComparisonOp string
```

<a name="Equal"></a>Define the different comparison operators as constants

```go
var (
    Equal            ComparisonOp = "="
    NotEqual         ComparisonOp = "!="
    LessThan         ComparisonOp = "<"
    LessThanEqual    ComparisonOp = "<="
    GreaterThan      ComparisonOp = ">"
    GreaterThanEqual ComparisonOp = ">="
)
```

<a name="Condition"></a>
## type [Condition](<https://github.com/mtnmunuklu/logen/blob/main/sigma/ast.go#L11-L15>)



```go
type Condition struct {
    Search      SearchExpr      `yaml:",omitempty" json:",omitempty"` // represents the search query
    Aggregation AggregationExpr `yaml:",omitempty" json:",omitempty"` // represents the aggregation operation
    // contains filtered or unexported fields
}
```

<a name="ParseCondition"></a>
### func [ParseCondition](<https://github.com/mtnmunuklu/logen/blob/main/sigma/condition_parser.go#L31>)

```go
func ParseCondition(input string) (Condition, error)
```

Parses the Sigma condition syntax and returns a Condition struct and/or an error

<a name="Condition.MarshalYAML"></a>
### func \(Condition\) [MarshalYAML](<https://github.com/mtnmunuklu/logen/blob/main/sigma/ast.go#L19>)

```go
func (c Condition) MarshalYAML() (interface{}, error)
```

This function is used to convert a Condition struct to YAML format. It takes the Condition struct and returns its YAML representation.

<a name="Condition.Position"></a>
### func \(Condition\) [Position](<https://github.com/mtnmunuklu/logen/blob/main/sigma/ast.go#L32>)

```go
func (c Condition) Position() (int, int)
```

Position returns the line and column of this Condition in the original input

<a name="Conditions"></a>
## type [Conditions](<https://github.com/mtnmunuklu/logen/blob/main/sigma/rule_parser.go#L96>)



```go
type Conditions []Condition
```

<a name="Conditions.MarshalYAML"></a>
### func \(Conditions\) [MarshalYAML](<https://github.com/mtnmunuklu/logen/blob/main/sigma/rule_parser.go#L136>)

```go
func (c Conditions) MarshalYAML() (interface{}, error)
```

MarshalYAML marshals the Conditions slice to YAML.

<a name="Conditions.UnmarshalYAML"></a>
### func \(\*Conditions\) [UnmarshalYAML](<https://github.com/mtnmunuklu/logen/blob/main/sigma/rule_parser.go#L99>)

```go
func (c *Conditions) UnmarshalYAML(node *yaml.Node) error
```

UnmarshalYAML unmarshals the YAML node to the Conditions slice.

<a name="Config"></a>
## type [Config](<https://github.com/mtnmunuklu/logen/blob/main/sigma/config_parser.go#L8-L17>)

Config is a struct that defines the Sigma configuration

```go
type Config struct {
    Title         string   // A short description of what this configuration does
    Order         int      // Defines the order of expansion when multiple config files are applicable
    Backends      []string // Lists the Sigma implementations that this config file is compatible with
    FieldMappings map[string]FieldMapping
    Logsources    map[string]LogsourceMapping
    // TODO: LogsourceMerging option
    DefaultIndex string                   // Defines a default index if no logsources match
    Placeholders map[string][]interface{} // Defines values for placeholders that might appear in Sigma rules
}
```

<a name="ParseConfig"></a>
### func [ParseConfig](<https://github.com/mtnmunuklu/logen/blob/main/sigma/config_parser.go#L75>)

```go
func ParseConfig(contents []byte) (Config, error)
```

ParseConfig takes a byte slice of YAML data and returns a Config struct or an error if unmarshaling fails

<a name="Count"></a>
## type [Count](<https://github.com/mtnmunuklu/logen/blob/main/sigma/ast.go#L249-L252>)

Count represents a count aggregation function.

```go
type Count struct {
    Field     string // the field to count
    GroupedBy string // the field to group by
}
```

<a name="Detection"></a>
## type [Detection](<https://github.com/mtnmunuklu/logen/blob/main/sigma/rule_parser.go#L46-L50>)



```go
type Detection struct {
    Searches   map[string]Search `yaml:",inline" json:",inline"`       // Searches holds a map of search query strings and their corresponding configurations.
    Conditions Conditions        `yaml:"condition" json:"condition"`   // Conditions holds a slice of conditions to be checked for the detection to occur.
    Timeframe  time.Duration     `yaml:",omitempty" json:",omitempty"` // Timeframe specifies the time duration within which the detection must occur.
}
```

<a name="Detection.UnmarshalYAML"></a>
### func \(\*Detection\) [UnmarshalYAML](<https://github.com/mtnmunuklu/logen/blob/main/sigma/rule_parser.go#L52>)

```go
func (d *Detection) UnmarshalYAML(node *yaml.Node) error
```



<a name="EventMatcher"></a>
## type [EventMatcher](<https://github.com/mtnmunuklu/logen/blob/main/sigma/rule_parser.go#L212>)



```go
type EventMatcher []FieldMatcher
```

<a name="EventMatcher.MarshalYAML"></a>
### func \(EventMatcher\) [MarshalYAML](<https://github.com/mtnmunuklu/logen/blob/main/sigma/rule_parser.go#L236>)

```go
func (f EventMatcher) MarshalYAML() (interface{}, error)
```

MarshalYAML returns a YAML representation of the EventMatcher struct

<a name="EventMatcher.UnmarshalYAML"></a>
### func \(\*EventMatcher\) [UnmarshalYAML](<https://github.com/mtnmunuklu/logen/blob/main/sigma/rule_parser.go#L215>)

```go
func (f *EventMatcher) UnmarshalYAML(node *yaml.Node) error
```

UnmarshalYAML parses the YAML node and sets the fields on the EventMatcher struct

<a name="FieldMapping"></a>
## type [FieldMapping](<https://github.com/mtnmunuklu/logen/blob/main/sigma/config_parser.go#L20-L23>)

FieldMapping is a struct that defines the target fields to be matched in Sigma rules

```go
type FieldMapping struct {
    TargetNames []string // The name(s) that appear in the events being matched

}
```

<a name="FieldMapping.UnmarshalYAML"></a>
### func \(\*FieldMapping\) [UnmarshalYAML](<https://github.com/mtnmunuklu/logen/blob/main/sigma/config_parser.go#L26>)

```go
func (f *FieldMapping) UnmarshalYAML(value *yaml.Node) error
```

UnmarshalYAML is a custom method for unmarshaling YAML data into FieldMapping

<a name="FieldMatcher"></a>
## type [FieldMatcher](<https://github.com/mtnmunuklu/logen/blob/main/sigma/rule_parser.go#L259-L264>)

FieldMatcher defines a matcher for a single field

```go
type FieldMatcher struct {
    Field     string        `yaml:",omitempty" json:",omitempty"`
    Modifiers []string      `yaml:",omitempty" json:",omitempty"`
    Values    []interface{} `yaml:",omitempty" json:",omitempty"`
    // contains filtered or unexported fields
}
```

<a name="FieldMatcher.Position"></a>
### func \(FieldMatcher\) [Position](<https://github.com/mtnmunuklu/logen/blob/main/sigma/rule_parser.go#L267>)

```go
func (f FieldMatcher) Position() (int, int)
```

Position returns the line and column of this FieldMatcher in the original input

<a name="FileType"></a>
## type [FileType](<https://github.com/mtnmunuklu/logen/blob/main/sigma/rule_or_config.go#L19>)

FileType represents the type of a Sigma file

```go
type FileType string
```

<a name="UnknownFile"></a>Possible file types

```go
const (
    UnknownFile FileType = ""        // Unknown file type
    InvalidFile FileType = "invalid" // Invalid file type
    RuleFile    FileType = "rule"    // Sigma rule file type
    ConfigFile  FileType = "config"  // Sigma config file type
)
```

<a name="InferFileType"></a>
### func [InferFileType](<https://github.com/mtnmunuklu/logen/blob/main/sigma/rule_or_config.go#L10>)

```go
func InferFileType(contents []byte) FileType
```

InferFileType attempts to infer the type of Sigma file by unmarshalling the YAML contents and checking if it contains certain required fields for a rule or config file. If there is an error unmarshalling the contents, it returns an invalid file type.

<a name="FileType.UnmarshalYAML"></a>
### func \(\*FileType\) [UnmarshalYAML](<https://github.com/mtnmunuklu/logen/blob/main/sigma/rule_or_config.go#L32>)

```go
func (f *FileType) UnmarshalYAML(node *yaml.Node) error
```

UnmarshalYAML is a custom unmarshaller for the FileType type. It checks if the YAML node contains certain required fields for a rule or config file, and sets the corresponding FileType value.

<a name="Logsource"></a>
## type [Logsource](<https://github.com/mtnmunuklu/logen/blob/main/sigma/rule_parser.go#L36-L44>)



```go
type Logsource struct {
    Category   string `yaml:",omitempty" json:",omitempty"` // The category of the log source
    Product    string `yaml:",omitempty" json:",omitempty"` // The product associated with the log source
    Service    string `yaml:",omitempty" json:",omitempty"` // The service associated with the log source
    Definition string `yaml:",omitempty" json:",omitempty"` // The definition of the log source

    // Any non-standard fields will end up in here
    AdditionalFields map[string]interface{} `yaml:",inline,omitempty" json:",inline,omitempty"` // Any additional fields in the YAML document
}
```

<a name="LogsourceIndexes"></a>
## type [LogsourceIndexes](<https://github.com/mtnmunuklu/logen/blob/main/sigma/config_parser.go#L53>)

LogsourceIndexes is a list of strings representing indexes for a logsource

```go
type LogsourceIndexes []string
```

<a name="LogsourceIndexes.UnmarshalYAML"></a>
### func \(\*LogsourceIndexes\) [UnmarshalYAML](<https://github.com/mtnmunuklu/logen/blob/main/sigma/config_parser.go#L56>)

```go
func (i *LogsourceIndexes) UnmarshalYAML(value *yaml.Node) error
```

UnmarshalYAML is a custom method for unmarshaling YAML data into LogsourceIndexes

<a name="LogsourceMapping"></a>
## type [LogsourceMapping](<https://github.com/mtnmunuklu/logen/blob/main/sigma/config_parser.go#L45-L50>)

LogsourceMapping defines the mapping between a logsource and its indexes, conditions, and rewrites

```go
type LogsourceMapping struct {
    Logsource  `yaml:",inline"` // A LogsourceMapping embeds the Logsource struct, which defines a set of fields that can be matched in Sigma rules
    Index      LogsourceIndexes // The index(es) that should be used for this logsource
    Conditions Search           // Conditions that are added to all rules targeting this logsource
    Rewrite    Logsource        // Rewrites this logsource (i.e. so that it can be matched by another lower precedence config)
}
```

<a name="Max"></a>
## type [Max](<https://github.com/mtnmunuklu/logen/blob/main/sigma/ast.go#L287-L290>)

Max is a type that represents a maximum aggregation function.

```go
type Max struct {
    Field     string // The field to apply the max function to.
    GroupedBy string // The field to group the results by.
}
```

<a name="Min"></a>
## type [Min](<https://github.com/mtnmunuklu/logen/blob/main/sigma/ast.go#L267-L270>)

Min represents the minimum aggregation function.

```go
type Min struct {
    Field     string // Field to apply the aggregation on
    GroupedBy string // Optional field to group the aggregation by
}
```

<a name="Near"></a>
## type [Near](<https://github.com/mtnmunuklu/logen/blob/main/sigma/ast.go#L200-L202>)

Define the Near struct with a Condition field.

```go
type Near struct {
    Condition SearchExpr
}
```

<a name="Not"></a>
## type [Not](<https://github.com/mtnmunuklu/logen/blob/main/sigma/ast.go#L88-L90>)

Not struct represents a negation of a search expression.

```go
type Not struct {
    Expr SearchExpr // The search expression to be negated.
}
```

<a name="OneOfIdentifier"></a>
## type [OneOfIdentifier](<https://github.com/mtnmunuklu/logen/blob/main/sigma/ast.go#L102-L104>)

OneOfIdentifier represents an expression that matches one of the search identifiers.

```go
type OneOfIdentifier struct {
    Ident SearchIdentifier
}
```

<a name="OneOfPattern"></a>
## type [OneOfPattern](<https://github.com/mtnmunuklu/logen/blob/main/sigma/ast.go#L145-L147>)

OneOfPattern represents a search expression that matches one of the search patterns.

```go
type OneOfPattern struct {
    Pattern string
}
```

<a name="OneOfThem"></a>
## type [OneOfThem](<https://github.com/mtnmunuklu/logen/blob/main/sigma/ast.go#L158>)

OneOfThem is a struct representing a search expression that matches if exactly one search result is matched.

```go
type OneOfThem struct{}
```

<a name="Or"></a>
## type [Or](<https://github.com/mtnmunuklu/logen/blob/main/sigma/ast.go#L65>)

Or is a slice of SearchExpr representing a logical "or" operation between multiple search expressions.

```go
type Or []SearchExpr
```

<a name="RelatedRule"></a>
## type [RelatedRule](<https://github.com/mtnmunuklu/logen/blob/main/sigma/rule_parser.go#L31-L34>)



```go
type RelatedRule struct {
    ID   string // The unique ID of the related rule
    Type string // The type of the related rule (e.g. "similar", "correlated", "superseded")
}
```

<a name="Rule"></a>
## type [Rule](<https://github.com/mtnmunuklu/logen/blob/main/sigma/rule_parser.go#L11-L29>)



```go
type Rule struct {
    // Required fields
    Title     string    // The title of the Sigma rule
    Logsource Logsource // The log source that the rule should be applied to
    Detection Detection // The detection logic of the rule

    // Optional fields
    ID          string        `yaml:",omitempty" json:",omitempty"` // The unique ID of the rule
    Related     []RelatedRule `yaml:",omitempty" json:",omitempty"` // Related rules, if any
    Status      string        `yaml:",omitempty" json:",omitempty"` // The status of the rule (e.g. "testing", "production")
    Description string        `yaml:",omitempty" json:",omitempty"` // A brief description of the rule
    Author      string        `yaml:",omitempty" json:",omitempty"` // The author of the rule
    Level       string        `yaml:",omitempty" json:",omitempty"` // The severity level of the rule (e.g. "low", "medium", "high")
    References  []string      `yaml:",omitempty" json:",omitempty"` // References related to the rule
    Tags        []string      `yaml:",omitempty" json:",omitempty"` // Tags that can be used to organize the rules

    // Any non-standard fields will end up in here
    AdditionalFields map[string]interface{} `yaml:",inline,omitempty" json:",inline,omitempty"` // Any additional fields in the YAML document
}
```

<a name="ParseRule"></a>
### func [ParseRule](<https://github.com/mtnmunuklu/logen/blob/main/sigma/rule_parser.go#L330>)

```go
func ParseRule(input []byte) (Rule, error)
```

ParseRule reads a byte slice and returns a parsed Rule object and an error \(if any\)

<a name="Search"></a>
## type [Search](<https://github.com/mtnmunuklu/logen/blob/main/sigma/rule_parser.go#L145-L149>)

Search defines a search criteria that can be used to match events.

```go
type Search struct {
    Keywords      []string       `yaml:",omitempty" json:",omitempty"` // Keywords to search for
    EventMatchers []EventMatcher `yaml:",omitempty" json:",omitempty"` // List of event matchers (maps of fields to values)
    // contains filtered or unexported fields
}
```

<a name="Search.MarshalYAML"></a>
### func \(Search\) [MarshalYAML](<https://github.com/mtnmunuklu/logen/blob/main/sigma/rule_parser.go#L191>)

```go
func (s Search) MarshalYAML() (interface{}, error)
```

MarshalYAML encodes the Search object into a YAML representation.

<a name="Search.Position"></a>
### func \(Search\) [Position](<https://github.com/mtnmunuklu/logen/blob/main/sigma/rule_parser.go#L152>)

```go
func (s Search) Position() (int, int)
```

Position returns the line and column of this Search in the original input

<a name="Search.UnmarshalYAML"></a>
### func \(\*Search\) [UnmarshalYAML](<https://github.com/mtnmunuklu/logen/blob/main/sigma/rule_parser.go#L157>)

```go
func (s *Search) UnmarshalYAML(node *yaml.Node) error
```

UnmarshalYAML decodes the YAML representation of a Search object.

<a name="SearchExpr"></a>
## type [SearchExpr](<https://github.com/mtnmunuklu/logen/blob/main/sigma/ast.go#L37-L40>)

SearchExpr is an interface that represents a search expression.

```go
type SearchExpr interface {
    // contains filtered or unexported methods
}
```

<a name="SearchIdentifier"></a>
## type [SearchIdentifier](<https://github.com/mtnmunuklu/logen/blob/main/sigma/ast.go#L180-L182>)

SearchIdentifier represents a search identifier, which is simply a string.

```go
type SearchIdentifier struct {
    Name string // The name of the identifier.
}
```

<a name="Sum"></a>
## type [Sum](<https://github.com/mtnmunuklu/logen/blob/main/sigma/ast.go#L325-L328>)

The Sum type represents an aggregation function that calculates the sum of a field.

```go
type Sum struct {
    Field     string // The name of the field to sum.
    GroupedBy string // The name of the field to group by, if any.
}
```

# sevaluator

```go
import "github.com/mtnmunuklu/logen/sigma/sevaluator"
```

## Index

- [func CaseSensitive\(e \*RuleEvaluator\)](<#CaseSensitive>)
- [func FuzzRuleMatches\(data \[\]byte\) int](<#FuzzRuleMatches>)
- [func SendMessageToOpenAI\(apiKey, content string\) \(string, error\)](<#SendMessageToOpenAI>)
- [type OpenAIClient](<#OpenAIClient>)
  - [func NewOpenAIClient\(apiKey string\) \*OpenAIClient](<#NewOpenAIClient>)
- [type OpenAIService](<#OpenAIService>)
- [type Option](<#Option>)
  - [func WithConfig\(config ...sigma.Config\) Option](<#WithConfig>)
  - [func WithPlaceholderExpander\(f func\(ctx context.Context, placeholderName string\) \(\[\]string, error\)\) Option](<#WithPlaceholderExpander>)
- [type Result](<#Result>)
- [type RuleEvaluator](<#RuleEvaluator>)
  - [func ForRule\(rule sigma.Rule, options ...Option\) \*RuleEvaluator](<#ForRule>)
  - [func \(rule RuleEvaluator\) Alters\(ctx context.Context\) \(Result, error\)](<#RuleEvaluator.Alters>)
  - [func \(rule RuleEvaluator\) Indexes\(\) \[\]string](<#RuleEvaluator.Indexes>)


<a name="CaseSensitive"></a>
## func [CaseSensitive](<https://github.com/mtnmunuklu/logen/blob/main/sigma/sevaluator/options.go#L37>)

```go
func CaseSensitive(e *RuleEvaluator)
```

CaseSensitive turns off the default Sigma behaviour that string operations are by default case\-insensitive This can increase performance \(especially for larger events\) by skipping expensive calls to strings.ToLower

<a name="FuzzRuleMatches"></a>
## func [FuzzRuleMatches](<https://github.com/mtnmunuklu/logen/blob/main/sigma/sevaluator/fuzz.go#L50>)

```go
func FuzzRuleMatches(data []byte) int
```

Fuzz function that checks if a given input byte slice can trigger an alteration to the system

<a name="SendMessageToOpenAI"></a>
## func [SendMessageToOpenAI](<https://github.com/mtnmunuklu/logen/blob/main/sigma/sevaluator/openai.go#L28>)

```go
func SendMessageToOpenAI(apiKey, content string) (string, error)
```

SendMessageToOpenAI sends a message to OpenAI and returns the response

<a name="OpenAIClient"></a>
## type [OpenAIClient](<https://github.com/mtnmunuklu/logen/blob/main/sigma/sevaluator/openai.go#L16-L18>)

OpenAIClient implements OpenAIService

```go
type OpenAIClient struct {
    *openai.Client
}
```

<a name="NewOpenAIClient"></a>
### func [NewOpenAIClient](<https://github.com/mtnmunuklu/logen/blob/main/sigma/sevaluator/openai.go#L21>)

```go
func NewOpenAIClient(apiKey string) *OpenAIClient
```

NewOpenAIClient creates a new OpenAIClient instance

<a name="OpenAIService"></a>
## type [OpenAIService](<https://github.com/mtnmunuklu/logen/blob/main/sigma/sevaluator/openai.go#L11-L13>)

OpenAIService interface defines the operations for OpenAI service

```go
type OpenAIService interface {
    CreateChatCompletion(context.Context, openai.ChatCompletionRequest) (*openai.ChatCompletionResponse, error)
}
```

<a name="Option"></a>
## type [Option](<https://github.com/mtnmunuklu/logen/blob/main/sigma/sevaluator/options.go#L10>)

Option is a function that takes a RuleEvaluator pointer and modifies its configuration

```go
type Option func(*RuleEvaluator)
```

<a name="WithConfig"></a>
### func [WithConfig](<https://github.com/mtnmunuklu/logen/blob/main/sigma/sevaluator/options.go#L26>)

```go
func WithConfig(config ...sigma.Config) Option
```

WithConfig returns an Option that sets the provided Sigma configs to the RuleEvaluator. The configs are used to initialize the RuleEvaluator, which creates field mappings and indexes for efficient evaluation of Sigma rules. The configs should be provided in the order of precedence, and the function will append them to the RuleEvaluator's config slice. After the configs are set, the function will recalculate the RuleEvaluator's indexes and field mappings.

<a name="WithPlaceholderExpander"></a>
### func [WithPlaceholderExpander](<https://github.com/mtnmunuklu/logen/blob/main/sigma/sevaluator/options.go#L16>)

```go
func WithPlaceholderExpander(f func(ctx context.Context, placeholderName string) ([]string, error)) Option
```

WithPlaceholderExpander returns an Option that sets the provided function as the placeholder expander for the RuleEvaluator. The placeholder expander is used to expand any placeholders that might be present in the Sigma rule before evaluation. The provided function should take a context and a placeholder name and return a slice of strings that replace the placeholder in the Sigma rule. If an error occurs during the expansion process, the function should return an error.

<a name="Result"></a>
## type [Result](<https://github.com/mtnmunuklu/logen/blob/main/sigma/sevaluator/evaluate.go#L36-L41>)

Result represents the evaluation result of a Sigma rule. It contains the search, condition, aggregation, and query results of the rule evaluation.

```go
type Result struct {
    Searches    map[string][]string // The map of search identifiers to their result values
    Conditions  map[int][]string    // The map of condition indices to their result values
    SourceTypes map[int]string      // The map of sourcetype indices to their result values
    Queries     map[int]string      // The map of query indices to their result values
}
```

<a name="RuleEvaluator"></a>
## type [RuleEvaluator](<https://github.com/mtnmunuklu/logen/blob/main/sigma/sevaluator/evaluate.go#L13-L22>)

RuleEvaluator represents a rule evaluator that is capable of computing the search, condition, and query results of a Sigma rule. It holds the rule configuration, search conditions, and field mappings necessary to apply the rule to log events and generate the query results.

```go
type RuleEvaluator struct {
    sigma.Rule
    // contains filtered or unexported fields
}
```

<a name="ForRule"></a>
### func [ForRule](<https://github.com/mtnmunuklu/logen/blob/main/sigma/sevaluator/evaluate.go#L26>)

```go
func ForRule(rule sigma.Rule, options ...Option) *RuleEvaluator
```

ForRule constructs a new RuleEvaluator with the given Sigma rule and evaluation options. It applies any provided options to the new RuleEvaluator and returns it.

<a name="RuleEvaluator.Alters"></a>
### func \(RuleEvaluator\) [Alters](<https://github.com/mtnmunuklu/logen/blob/main/sigma/sevaluator/evaluate.go#L45>)

```go
func (rule RuleEvaluator) Alters(ctx context.Context) (Result, error)
```

This function returns a Result object containing the evaluation results for the rule's Detection field. It uses the evaluateSearch, evaluateSearchExpression and evaluateAggregationExpression functions to compute the results.

<a name="RuleEvaluator.Indexes"></a>
### func \(RuleEvaluator\) [Indexes](<https://github.com/mtnmunuklu/logen/blob/main/sigma/sevaluator/indexes.go#L63>)

```go
func (rule RuleEvaluator) Indexes() []string
```

The Indexes method returns the possible indexes for the current rule

# docker

```go
import "github.com/mtnmunuklu/logen/tools/docker"
```

## Index



# grammar

```go
import "github.com/mtnmunuklu/logen/sigma/internal/grammar"
```

## Index

- [type Aggregation](<#Aggregation>)
- [type AggregationFunction](<#AggregationFunction>)
- [type ComparisonOp](<#ComparisonOp>)
- [type Condition](<#Condition>)
- [type Conjunction](<#Conjunction>)
- [type Disjunction](<#Disjunction>)
- [type OneAllOf](<#OneAllOf>)
- [type Term](<#Term>)


<a name="Aggregation"></a>
## type [Aggregation](<https://github.com/mtnmunuklu/logen/blob/main/sigma/internal/grammar/aggregation_expression.go#L4-L19>)

Aggregation represents a struct for grouping and aggregating data

```go
type Aggregation struct {
    // Function holds the aggregation function used in the aggregation
    Function AggregationFunction `@@`

    // AggregationField holds the field used in the aggregation
    AggregationField string `("(" (@SearchIdentifier)? ")")?`

    // GroupField holds the field used for grouping data
    GroupField string `("by" @SearchIdentifier)?`

    // Comparison holds the comparison operator used in the aggregation
    Comparison *ComparisonOp `(@@`

    // Threshold holds the threshold value used in the aggregation comparison
    Threshold float64 `@ComparisonValue)?`
}
```

<a name="AggregationFunction"></a>
## type [AggregationFunction](<https://github.com/mtnmunuklu/logen/blob/main/sigma/internal/grammar/aggregation_expression.go#L22-L28>)

AggregationFunction represents the type of aggregation function

```go
type AggregationFunction struct {
    Count bool `@"count"`
    Min   bool `| @"min"`
    Max   bool `| @"max"`
    Avg   bool `| @"avg"`
    Sum   bool `| @"sum"`
}
```

<a name="ComparisonOp"></a>
## type [ComparisonOp](<https://github.com/mtnmunuklu/logen/blob/main/sigma/internal/grammar/aggregation_expression.go#L31-L38>)

ComparisonOp represents the type of comparison operator used in the aggregation

```go
type ComparisonOp struct {
    Equal            bool `@"="`
    NotEqual         bool `| @"!="`
    LessThan         bool `| @"<"`
    LessThanEqual    bool `| @"<="`
    GreaterThan      bool `| @">"`
    GreaterThanEqual bool `| @">="`
}
```

<a name="Condition"></a>
## type [Condition](<https://github.com/mtnmunuklu/logen/blob/main/sigma/internal/grammar/search_expression.go#L3-L6>)



```go
type Condition struct {
    Search      Disjunction  `@@`        // Represents the search condition
    Aggregation *Aggregation `("|" @@)?` // Represents an optional aggregation function and its parameters
}
```

<a name="Conjunction"></a>
## type [Conjunction](<https://github.com/mtnmunuklu/logen/blob/main/sigma/internal/grammar/search_expression.go#L12-L14>)



```go
type Conjunction struct {
    Nodes []*Term `@@ ("and" @@)*` // Represents a conjunction of terms
}
```

<a name="Disjunction"></a>
## type [Disjunction](<https://github.com/mtnmunuklu/logen/blob/main/sigma/internal/grammar/search_expression.go#L8-L10>)



```go
type Disjunction struct {
    Nodes []*Conjunction `@@ ("or" @@)*` // Represents a disjunction of conjunctions
}
```

<a name="OneAllOf"></a>
## type [OneAllOf](<https://github.com/mtnmunuklu/logen/blob/main/sigma/internal/grammar/search_expression.go#L23-L30>)



```go
type OneAllOf struct {
    OneOfIdentifier *string `"1 of" @SearchIdentifier`            // Represents a one-of identifier
    AllOfIdentifier *string `| "all of" @SearchIdentifier`        // Represents an all-of identifier
    OneOfPattern    *string `| "1 of" @SearchIdentifierPattern`   // Represents a one-of pattern
    AllOfPattern    *string `| "all of" @SearchIdentifierPattern` // Represents an all-of pattern
    OneOfThem       bool    `| @("1 of them")`                    // Represents the "1 of them" keyword
    ALlOfThem       bool    `| @("all of them")`                  // Represents the "all of them" keyword
}
```

<a name="Term"></a>
## type [Term](<https://github.com/mtnmunuklu/logen/blob/main/sigma/internal/grammar/search_expression.go#L16-L21>)



```go
type Term struct {
    Negated       *Term        `"not" @@`            // Represents a negation of a term
    OneAllOf      *OneAllOf    `| @@`                // Represents a one-of or all-of pattern
    Identifer     *string      `| @SearchIdentifier` // Represents a search identifier
    Subexpression *Disjunction `| "(" @@ ")"`        // Represents a subexpression
}
```

# modifiers

```go
import "github.com/mtnmunuklu/logen/sigma/sevaluator/modifiers"
```

## Index

- [Variables](<#variables>)
- [type Comparator](<#Comparator>)
- [type ComparatorFunc](<#ComparatorFunc>)
  - [func GetComparator\(modifiers ...string\) \(ComparatorFunc, error\)](<#GetComparator>)
  - [func GetComparatorCaseSensitive\(modifiers ...string\) \(ComparatorFunc, error\)](<#GetComparatorCaseSensitive>)
- [type SyntheticDataGenerator](<#SyntheticDataGenerator>)
  - [func NewSyntheticDataGenerator\(\) \*SyntheticDataGenerator](<#NewSyntheticDataGenerator>)
  - [func \(g \*SyntheticDataGenerator\) GenerateSyntheticValue\(value string, operationType string\) string](<#SyntheticDataGenerator.GenerateSyntheticValue>)
  - [func \(g \*SyntheticDataGenerator\) GetNthIP\(ipNet \*net.IPNet, n int\) net.IP](<#SyntheticDataGenerator.GetNthIP>)
  - [func \(g \*SyntheticDataGenerator\) IPRange\(ipNet \*net.IPNet\) \[\]net.IP](<#SyntheticDataGenerator.IPRange>)
- [type ValueModifier](<#ValueModifier>)


## Variables

<a name="Comparators"></a>

```go
var Comparators = map[string]Comparator{
    "contains":   contains{/* contains filtered or unexported fields */},
    "endswith":   endswith{/* contains filtered or unexported fields */},
    "startswith": startswith{/* contains filtered or unexported fields */},
    "re":         re{/* contains filtered or unexported fields */},
    "cidr":       cidr{/* contains filtered or unexported fields */},
    "gt":         gt{/* contains filtered or unexported fields */},
    "gte":        gte{/* contains filtered or unexported fields */},
    "lt":         lt{/* contains filtered or unexported fields */},
    "lte":        lte{/* contains filtered or unexported fields */},
}
```

<a name="ComparatorsCaseSensitive"></a>

```go
var ComparatorsCaseSensitive = map[string]Comparator{
    "contains":   containsCS{/* contains filtered or unexported fields */},
    "endswith":   endswithCS{/* contains filtered or unexported fields */},
    "startswith": startswithCS{/* contains filtered or unexported fields */},
    "re":         re{/* contains filtered or unexported fields */},
    "cidr":       cidr{/* contains filtered or unexported fields */},
    "gt":         gt{/* contains filtered or unexported fields */},
    "gte":        gte{/* contains filtered or unexported fields */},
    "lt":         lt{/* contains filtered or unexported fields */},
    "lte":        lte{/* contains filtered or unexported fields */},
}
```

<a name="ValueModifiers"></a>

```go
var ValueModifiers = map[string]ValueModifier{
    "base64": b64{},
    "wide":   wide{},
}
```

<a name="Comparator"></a>
## type [Comparator](<https://github.com/mtnmunuklu/logen/blob/main/sigma/sevaluator/modifiers/modifiers.go#L66-L68>)



```go
type Comparator interface {
    Alters(field any, value any) (string, error)
}
```

<a name="ComparatorFunc"></a>
## type [ComparatorFunc](<https://github.com/mtnmunuklu/logen/blob/main/sigma/sevaluator/modifiers/modifiers.go#L70>)



```go
type ComparatorFunc func(field, value any) (string, error)
```

<a name="GetComparator"></a>
### func [GetComparator](<https://github.com/mtnmunuklu/logen/blob/main/sigma/sevaluator/modifiers/modifiers.go#L14>)

```go
func GetComparator(modifiers ...string) (ComparatorFunc, error)
```



<a name="GetComparatorCaseSensitive"></a>
### func [GetComparatorCaseSensitive](<https://github.com/mtnmunuklu/logen/blob/main/sigma/sevaluator/modifiers/modifiers.go#L18>)

```go
func GetComparatorCaseSensitive(modifiers ...string) (ComparatorFunc, error)
```



<a name="SyntheticDataGenerator"></a>
## type [SyntheticDataGenerator](<https://github.com/mtnmunuklu/logen/blob/main/sigma/sevaluator/modifiers/synthetic_data_generator.go#L13-L15>)

SyntheticDataGenerator is used for generating synthetic data.

```go
type SyntheticDataGenerator struct {
    // contains filtered or unexported fields
}
```

<a name="NewSyntheticDataGenerator"></a>
### func [NewSyntheticDataGenerator](<https://github.com/mtnmunuklu/logen/blob/main/sigma/sevaluator/modifiers/synthetic_data_generator.go#L18>)

```go
func NewSyntheticDataGenerator() *SyntheticDataGenerator
```

NewSyntheticDataGenerator creates a new instance of SyntheticDataGenerator.

<a name="SyntheticDataGenerator.GenerateSyntheticValue"></a>
### func \(\*SyntheticDataGenerator\) [GenerateSyntheticValue](<https://github.com/mtnmunuklu/logen/blob/main/sigma/sevaluator/modifiers/synthetic_data_generator.go#L27>)

```go
func (g *SyntheticDataGenerator) GenerateSyntheticValue(value string, operationType string) string
```

GenerateSyntheticValue generates a synthetic value based on a specific operation type.

<a name="SyntheticDataGenerator.GetNthIP"></a>
### func \(\*SyntheticDataGenerator\) [GetNthIP](<https://github.com/mtnmunuklu/logen/blob/main/sigma/sevaluator/modifiers/synthetic_data_generator.go#L157>)

```go
func (g *SyntheticDataGenerator) GetNthIP(ipNet *net.IPNet, n int) net.IP
```

GetNthIP returns the nth IP address in the given CIDR block

<a name="SyntheticDataGenerator.IPRange"></a>
### func \(\*SyntheticDataGenerator\) [IPRange](<https://github.com/mtnmunuklu/logen/blob/main/sigma/sevaluator/modifiers/synthetic_data_generator.go#L147>)

```go
func (g *SyntheticDataGenerator) IPRange(ipNet *net.IPNet) []net.IP
```

IPRange generates all IP addresses in the given CIDR block

<a name="ValueModifier"></a>
## type [ValueModifier](<https://github.com/mtnmunuklu/logen/blob/main/sigma/sevaluator/modifiers/modifiers.go#L74-L76>)

ValueModifier modifies the expected value before it is passed to the comparator. For example, the \`base64\` modifier converts the expected value to base64.

```go
type ValueModifier interface {
    Modify(value any) (any, error)
}
```

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
